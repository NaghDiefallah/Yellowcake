<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:vm="using:Yellowcake.ViewModels"
             xmlns:models="clr-namespace:Yellowcake.Models"
             x:Class="Yellowcake.Views.InstalledModsView"
             x:DataType="vm:MainViewModel">
	<Panel Margin="0,8">
		<ListBox ItemsSource="{Binding InstalledMods}"
                 Background="Transparent"
                 BorderThickness="0"
                 Padding="4">
			<ListBox.Styles>
				<Style Selector="ListBoxItem">
					<Setter Property="Background" Value="Transparent"/>
					<Setter Property="Padding" Value="0,0,0,10"/>
					<Setter Property="Template">
						<ControlTemplate>
							<ContentPresenter Content="{TemplateBinding Content}"
                                              ContentTemplate="{TemplateBinding ContentTemplate}"/>
						</ControlTemplate>
					</Setter>
				</Style>
			</ListBox.Styles>

			<ListBox.ItemTemplate>
				<DataTemplate x:DataType="models:Mod">
					<Border Background="{DynamicResource CardBackgroundBrush}"
                            Padding="24,18"
                            CornerRadius="12"
                            BorderBrush="{DynamicResource BorderBrush}"
                            BorderThickness="1">
						<Border.Transitions>
							<Transitions>
								<BrushTransition Property="BorderBrush" Duration="0:0:0.2"/>
								<TransformOperationsTransition Property="RenderTransform" Duration="0:0:0.1"/>
							</Transitions>
						</Border.Transitions>

						<Border.Styles>
							<Style Selector="Border:pointerover">
								<Setter Property="BorderBrush" Value="{DynamicResource SystemAccentBrush}"/>
								<Setter Property="Background" Value="#161616"/>
							</Style>
							<Style Selector="Border.ModCard[Opacity=0.5]">
								<Setter Property="Opacity" Value="0.5"/>
							</Style>
						</Border.Styles>

						<Grid ColumnDefinitions="*, 150, 180, 100">
							<StackPanel VerticalAlignment="Center" Spacing="8">
								<StackPanel Orientation="Horizontal" Spacing="10">
									<TextBlock Text="{Binding Name}"
                                             FontWeight="Bold"
                                             FontSize="17"
                                             Foreground="{DynamicResource MainTextBrush}"/>

									<Border IsVisible="{Binding HasUpdate}"
                                            Background="{DynamicResource SystemAccentBrush}"
                                            Padding="8,2" CornerRadius="4">
										<StackPanel Orientation="Horizontal" Spacing="4">
											<PathIcon Data="{StaticResource RefreshIcon}" Width="10" Height="10" Foreground="Black"/>
											<TextBlock Text="UPDATE" FontSize="9" FontWeight="Black" Foreground="Black"/>
										</StackPanel>
									</Border>
								</StackPanel>

								<StackPanel Orientation="Horizontal" Spacing="12">
									<StackPanel Orientation="Horizontal" Spacing="4">
										<PathIcon Data="{StaticResource UserIcon}" Width="10" Foreground="{DynamicResource SubTextBrush}" Opacity="0.5"/>
										<TextBlock Text="{Binding Author}" FontSize="12" Foreground="{DynamicResource SubTextBrush}" Opacity="0.8"/>
									</StackPanel>
									<TextBlock Text="â€¢" FontSize="12" Foreground="{DynamicResource SubTextBrush}" Opacity="0.3"/>
									<TextBlock Text="{Binding Version, StringFormat='v{0}'}" FontSize="12" Foreground="{DynamicResource SubTextBrush}" Opacity="0.5"/>
								</StackPanel>
							</StackPanel>

							<StackPanel Grid.Column="1" VerticalAlignment="Center" HorizontalAlignment="Left" Spacing="6">
								<Border IsVisible="{Binding IsVoicePack}"
                                        Background="#15FFFFFF" BorderBrush="#33FFFFFF" BorderThickness="1"
                                        CornerRadius="4" Padding="8,3">
									<TextBlock Text="VOICE PACK" FontSize="9" FontWeight="SemiBold" Foreground="{DynamicResource SubTextBrush}"/>
								</Border>
								<Border IsVisible="{Binding IsLivery}"
                                        Background="#15FFFFFF" BorderBrush="#33FFFFFF" BorderThickness="1"
                                        CornerRadius="4" Padding="8,3">
									<TextBlock Text="LIVERY" FontSize="9" FontWeight="SemiBold" Foreground="{DynamicResource SubTextBrush}"/>
								</Border>
							</StackPanel>

							<StackPanel Grid.Column="2" VerticalAlignment="Center" HorizontalAlignment="Center">
								<Border Background="#10FFFFFF" CornerRadius="20" Padding="4,4,12,4">
									<StackPanel Orientation="Horizontal" Spacing="12">
										<ToggleSwitch IsChecked="{Binding IsEnabled}"
                                                    OnContent="" OffContent=""
                                                    MinWidth="0"
                                                    Theme="{StaticResource MaterialDesignToggleSwitch}"
                                                    Command="{Binding $parent[Window].((vm:MainViewModel)DataContext).ToggleModCommand}"
                                                    CommandParameter="{Binding}"/>
										<TextBlock Text="{Binding IsEnabled, Converter={StaticResource BoolToEnabledTextConverter}}"
                                                 FontSize="11" VerticalAlignment="Center"
                                                 Foreground="{Binding IsEnabled, Converter={StaticResource BoolToAccentBrushConverter}}"
                                                 FontWeight="Heavy" LetterSpacing="0.5"/>
									</StackPanel>
								</Border>
							</StackPanel>

							<StackPanel Grid.Column="3" Orientation="Horizontal" HorizontalAlignment="Right" Spacing="12">
								<Button Classes="Icon"
                                        Width="40" Height="40"
                                        ToolTip.Tip="Open Folder"
                                        Command="{Binding $parent[Window].((vm:MainViewModel)DataContext).OpenModFolderCommand}"
                                        CommandParameter="{Binding}">
									<PathIcon Data="{StaticResource FolderIcon}" Width="16" Height="16" Opacity="0.6"/>
								</Button>

								<Button Command="{Binding $parent[Window].((vm:MainViewModel)DataContext).DeleteModCommand}"
                                        CommandParameter="{Binding}"
                                        Classes="Icon"
                                        ToolTip.Tip="Uninstall"
                                        Width="40" Height="40"
                                        Background="#15FF4444">
									<PathIcon Data="{StaticResource DeleteIcon}" Width="16" Height="16" Foreground="{DynamicResource WarningBrush}"/>
								</Button>
							</StackPanel>
						</Grid>
					</Border>
				</DataTemplate>
			</ListBox.ItemTemplate>
		</ListBox>

		<StackPanel IsVisible="{Binding !InstalledMods.Count}"
                    VerticalAlignment="Center" HorizontalAlignment="Center" Spacing="20">
			<Panel>
				<Ellipse Width="80" Height="80" Fill="{DynamicResource SystemAccentBrush}" Opacity="0.1">
					<Ellipse.Effect>
						<BlurEffect Radius="40"/>
					</Ellipse.Effect>
				</Ellipse>
				<PathIcon Data="{StaticResource BoxIcon}" Width="40" Height="40" Opacity="0.4"/>
			</Panel>
			<StackPanel Spacing="6">
				<TextBlock Text="Library Empty" FontSize="20" FontWeight="Light" HorizontalAlignment="Center" LetterSpacing="1"/>
				<TextBlock Text="Your installed mods will appear here" FontSize="13" Opacity="0.4" HorizontalAlignment="Center"/>
			</StackPanel>
		</StackPanel>
	</Panel>
</UserControl>